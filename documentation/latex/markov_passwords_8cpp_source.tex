\hypertarget{markov_passwords_8cpp_source}{}\doxysection{markov\+Passwords.\+cpp}
\label{markov_passwords_8cpp_source}\index{markovPasswords.cpp@{markovPasswords.cpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#include "\mbox{\hyperlink{markov_passwords_8h}{markovPasswords.h}}"}}
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{00004 \textcolor{preprocessor}{\#include <chrono>}}
\DoxyCodeLine{00005 \textcolor{preprocessor}{\#include <thread>}}
\DoxyCodeLine{00006 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{00007 \textcolor{preprocessor}{\#include <mutex>}}
\DoxyCodeLine{00008 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{00009 }
\DoxyCodeLine{\Hypertarget{markov_passwords_8cpp_source_l00010}\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a82a0edae676072c420fe74882d87a3cc}{00010}} \mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a82a0edae676072c420fe74882d87a3cc}{Markov::API::MarkovPasswords::MarkovPasswords}}() : \mbox{\hyperlink{namespace_markov}{Markov}}::\mbox{\hyperlink{class_markov_1_1_model}{Model}}<char>()\{}
\DoxyCodeLine{00011     }
\DoxyCodeLine{00012     }
\DoxyCodeLine{00013 \}}
\DoxyCodeLine{00014 }
\DoxyCodeLine{\Hypertarget{markov_passwords_8cpp_source_l00015}\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_ab7f0caaea1f96d4fdeea126f78d7081f}{00015}} \mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a82a0edae676072c420fe74882d87a3cc}{Markov::API::MarkovPasswords::MarkovPasswords}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filename) \{}
\DoxyCodeLine{00016     }
\DoxyCodeLine{00017     std::ifstream* importFile;}
\DoxyCodeLine{00018 }
\DoxyCodeLine{00019     this-\/>Import(filename);}
\DoxyCodeLine{00020     }
\DoxyCodeLine{00021     \textcolor{comment}{//std::ifstream* newFile(filename);}}
\DoxyCodeLine{00022     }
\DoxyCodeLine{00023     \textcolor{comment}{//importFile = newFile; }}
\DoxyCodeLine{00024 }
\DoxyCodeLine{00025 \}}
\DoxyCodeLine{00026 }
\DoxyCodeLine{\Hypertarget{markov_passwords_8cpp_source_l00027}\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_ac3fb665ee48937ca845d930e72e07917}{00027}} std::ifstream* \mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_ac3fb665ee48937ca845d930e72e07917}{Markov::API::MarkovPasswords::OpenDatasetFile}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filename)\{}
\DoxyCodeLine{00028 }
\DoxyCodeLine{00029     std::ifstream* datasetFile;}
\DoxyCodeLine{00030 }
\DoxyCodeLine{00031     std::ifstream newFile(filename);}
\DoxyCodeLine{00032 }
\DoxyCodeLine{00033     datasetFile = \&newFile;}
\DoxyCodeLine{00034 }
\DoxyCodeLine{00035     this-\/>Import(datasetFile);}
\DoxyCodeLine{00036     \textcolor{keywordflow}{return} datasetFile;}
\DoxyCodeLine{00037 \}}
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039 }
\DoxyCodeLine{\Hypertarget{markov_passwords_8cpp_source_l00040}\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a2fd4423ae3850e258dcb6b11a7feb9b2}{00040}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a2fd4423ae3850e258dcb6b11a7feb9b2}{Markov::API::MarkovPasswords::Train}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* datasetFileName, \textcolor{keywordtype}{char} delimiter, \textcolor{keywordtype}{int} threads)   \{}
\DoxyCodeLine{00041     \mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_concurrency_1_1_thread_shared_list_handler}{Markov::API::Concurrency::ThreadSharedListHandler}} listhandler(datasetFileName);}
\DoxyCodeLine{00042     \textcolor{keyword}{auto} start = std::chrono::high\_resolution\_clock::now();}
\DoxyCodeLine{00043 }
\DoxyCodeLine{00044     std::vector<std::thread*> threadsV;}
\DoxyCodeLine{00045     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<threads;i++)\{}
\DoxyCodeLine{00046         threadsV.push\_back(\textcolor{keyword}{new} std::thread(\&\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a5f51b0fdb75101b797f38b08da84848e}{Markov::API::MarkovPasswords::TrainThread}}, \textcolor{keyword}{this}, \&listhandler, delimiter));}
\DoxyCodeLine{00047     \}}
\DoxyCodeLine{00048 }
\DoxyCodeLine{00049     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<threads;i++)\{}
\DoxyCodeLine{00050         threadsV[i]-\/>join();}
\DoxyCodeLine{00051         \textcolor{keyword}{delete} threadsV[i];}
\DoxyCodeLine{00052     \}}
\DoxyCodeLine{00053     \textcolor{keyword}{auto} finish = std::chrono::high\_resolution\_clock::now();}
\DoxyCodeLine{00054     std::chrono::duration<double> elapsed = finish -\/ start;}
\DoxyCodeLine{00055     std::cout << \textcolor{stringliteral}{"Elapsed time: "} << elapsed.count() << \textcolor{stringliteral}{" s\(\backslash\)n"};}
\DoxyCodeLine{00056 }
\DoxyCodeLine{00057 \}}
\DoxyCodeLine{00058 }
\DoxyCodeLine{\Hypertarget{markov_passwords_8cpp_source_l00059}\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a5f51b0fdb75101b797f38b08da84848e}{00059}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a5f51b0fdb75101b797f38b08da84848e}{Markov::API::MarkovPasswords::TrainThread}}(\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_concurrency_1_1_thread_shared_list_handler}{Markov::API::Concurrency::ThreadSharedListHandler}} *listhandler, \textcolor{keywordtype}{char} delimiter)\{}
\DoxyCodeLine{00060     \textcolor{keywordtype}{char} format\_str[] =\textcolor{stringliteral}{"\%ld,\%s"};}
\DoxyCodeLine{00061     format\_str[2]=delimiter;}
\DoxyCodeLine{00062     std::string line;}
\DoxyCodeLine{00063     \textcolor{keywordflow}{while} (listhandler-\/>\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_concurrency_1_1_thread_shared_list_handler_a068e1a9ff477de23a44c10230df416a5}{next}}(\&line)) \{}
\DoxyCodeLine{00064         \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} oc;}
\DoxyCodeLine{00065         \textcolor{keywordflow}{if} (line.size() > 100) \{}
\DoxyCodeLine{00066             line = line.substr(0, 100);}
\DoxyCodeLine{00067         \}}
\DoxyCodeLine{00068         \textcolor{keywordtype}{char}* linebuf = \textcolor{keyword}{new} \textcolor{keywordtype}{char}[line.length()+5];}
\DoxyCodeLine{00069 \textcolor{preprocessor}{\#ifdef \_WIN32}}
\DoxyCodeLine{00070         sscanf\_s(line.c\_str(), format\_str, \&oc, linebuf, line.length()+5);}
\DoxyCodeLine{00071 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00072         sscanf(line.c\_str(), format\_str, \&oc, linebuf);}
\DoxyCodeLine{00073 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00074         this-\/>AdjustEdge((\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)linebuf, oc); }
\DoxyCodeLine{00075         \textcolor{keyword}{delete} linebuf;}
\DoxyCodeLine{00076     \}}
\DoxyCodeLine{00077 \}}
\DoxyCodeLine{00078 }
\DoxyCodeLine{00079 }
\DoxyCodeLine{\Hypertarget{markov_passwords_8cpp_source_l00080}\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a4f4997da3a6cd3bd2717ce9759736660}{00080}} std::ofstream* \mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a4f4997da3a6cd3bd2717ce9759736660}{Markov::API::MarkovPasswords::Save}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* filename) \{}
\DoxyCodeLine{00081     std::ofstream* exportFile;}
\DoxyCodeLine{00082 }
\DoxyCodeLine{00083     std::ofstream newFile(filename);}
\DoxyCodeLine{00084 }
\DoxyCodeLine{00085     exportFile = \&newFile;}
\DoxyCodeLine{00086     }
\DoxyCodeLine{00087     this-\/>Export(exportFile);}
\DoxyCodeLine{00088     \textcolor{keywordflow}{return} exportFile;}
\DoxyCodeLine{00089 \}}
\DoxyCodeLine{00090 }
\DoxyCodeLine{00091 }
\DoxyCodeLine{\Hypertarget{markov_passwords_8cpp_source_l00092}\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a13886b29051abf3edeed97bd7f985f39}{00092}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_a13886b29051abf3edeed97bd7f985f39}{Markov::API::MarkovPasswords::Generate}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} n, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* wordlistFileName, \textcolor{keywordtype}{int} minLen, \textcolor{keywordtype}{int} maxLen, \textcolor{keywordtype}{int} threads)  \{}
\DoxyCodeLine{00093     \textcolor{keywordtype}{char}* res;}
\DoxyCodeLine{00094     \textcolor{keywordtype}{char} print[100];}
\DoxyCodeLine{00095     std::ofstream wordlist; }
\DoxyCodeLine{00096     wordlist.open(wordlistFileName);}
\DoxyCodeLine{00097     std::mutex mlock;}
\DoxyCodeLine{00098     \textcolor{keywordtype}{int} iterationsPerThread = n/threads;}
\DoxyCodeLine{00099     \textcolor{keywordtype}{int} iterationsCarryOver = n\%threads;}
\DoxyCodeLine{00100     std::vector<std::thread*> threadsV;}
\DoxyCodeLine{00101     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<threads;i++)\{}
\DoxyCodeLine{00102         threadsV.push\_back(\textcolor{keyword}{new} std::thread(\&\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_ac2703ec2d5c97adaf8d205000ca34756}{Markov::API::MarkovPasswords::GenerateThread}}, \textcolor{keyword}{this}, \&mlock, iterationsPerThread, \&wordlist, minLen, maxLen));}
\DoxyCodeLine{00103     \}}
\DoxyCodeLine{00104 }
\DoxyCodeLine{00105     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<threads;i++)\{}
\DoxyCodeLine{00106         threadsV[i]-\/>join();}
\DoxyCodeLine{00107         \textcolor{keyword}{delete} threadsV[i];}
\DoxyCodeLine{00108     \}}
\DoxyCodeLine{00109 }
\DoxyCodeLine{00110     this-\/>GenerateThread(\&mlock, iterationsCarryOver, \&wordlist, minLen, maxLen);}
\DoxyCodeLine{00111     }
\DoxyCodeLine{00112 \}}
\DoxyCodeLine{00113 }
\DoxyCodeLine{\Hypertarget{markov_passwords_8cpp_source_l00114}\mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_ac2703ec2d5c97adaf8d205000ca34756}{00114}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_markov_1_1_a_p_i_1_1_markov_passwords_ac2703ec2d5c97adaf8d205000ca34756}{Markov::API::MarkovPasswords::GenerateThread}}(std::mutex *outputLock, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} n, std::ofstream *wordlist, \textcolor{keywordtype}{int} minLen, \textcolor{keywordtype}{int} maxLen)  \{}
\DoxyCodeLine{00115     \textcolor{keywordtype}{char}* res = \textcolor{keyword}{new} \textcolor{keywordtype}{char}[maxLen+5];}
\DoxyCodeLine{00116     \textcolor{keywordflow}{if}(n==0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{00117 }
\DoxyCodeLine{00118     \mbox{\hyperlink{class_markov_1_1_random_1_1_marsaglia}{Markov::Random::Marsaglia}} MarsagliaRandomEngine;}
\DoxyCodeLine{00119     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; i++) \{}
\DoxyCodeLine{00120         this-\/>RandomWalk(\&MarsagliaRandomEngine, minLen, maxLen, res); }
\DoxyCodeLine{00121         outputLock-\/>lock();}
\DoxyCodeLine{00122         *wordlist << res << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{00123         outputLock-\/>unlock();}
\DoxyCodeLine{00124     \}}
\DoxyCodeLine{00125 \}}

\end{DoxyCode}
